# ğŸ“š KT ê±·ë‹¤ê°€ì„œì¬ - AI ê¸°ë°˜ ìë™ ì¶œê°„ ë° êµ¬ë… í”Œë«í¼

> í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ê¸°ë°˜ ì „ìì±… ìë™ ì¶œê°„ ë° êµ¬ë… í”Œë«í¼  
> Spring Boot + React + Kubernetes + Kafka ê¸°ë°˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í”„ë¡œì íŠ¸  
> Azure + Dockerë¥¼ í†µí•œ ë°°í¬ ë° Githubì—°ë™ CI/CD ìë™ ë°°í¬   

---

## ğŸ“ í”„ë¡œì íŠ¸ ëª©ì  ë° ì„¤ëª…
- "AI IN ì„œì¬"ëŠ” ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì½˜í…ì¸ ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìš”ì•½(Summarization), í‘œì§€ ë””ìì¸ ìƒì„±(Image Generation), ìë™ ì¶œê°„ ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ìƒì„±í˜• AI ê¸°ë°˜ ë…ì„œ ì½˜í…ì¸  í”Œë«í¼ì…ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì›í•˜ëŠ” ì±…ì„ ì§ì ‘ êµ¬ë§¤í•˜ê±°ë‚˜ ì›”ê°„ êµ¬ë… ì„œë¹„ìŠ¤ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ì±…ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, 'ë‚´ ì„œì¬'ì—ì„œ ì†Œì¥í•œ ë„ì„œë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë³¸ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ëª©í‘œëŠ” Spring Bootì™€ React ê¸°ë°˜ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜(MSA)ë¥¼ ì§ì ‘ ì„¤ê³„ ë° êµ¬í˜„í•˜ê³ , ì´ë¥¼ Azure Kubernetes Service (AKS) í™˜ê²½ì—ì„œ Dockerë¥¼ í™œìš©í•´ ë°°í¬í•˜ë©°, GitHub Actions ê¸°ë°˜ì˜ CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë“± í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì˜ ì „ ê³¼ì •ì„ ê²½í—˜í•˜ê³  ì‹¤ìŠµí•˜ëŠ” ë° ìˆìŠµë‹ˆë‹¤.
- ì‘ê°€ê°€ ê¸€ì„ ì‘ì„±í•˜ë©´ AIê°€ ìë™ìœ¼ë¡œ í‘œì§€ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  ì „ìì±…ìœ¼ë¡œ ì¶œê°„
- êµ¬ë…ìëŠ” ì›”ì •ì•¡ìœ¼ë¡œ ì±…ì„ ì—´ëŒí•˜ê³ , KT ê³ ê°ì€ í¬ì¸íŠ¸ í˜œíƒì„ ë°›ì„ ìˆ˜ ìˆìŒ
- 3íšŒ ì´ìƒ ì—´ëŒëœ ë„ì„œëŠ” 'ë² ìŠ¤íŠ¸ì…€ëŸ¬'ë¡œ ë¶„ë¥˜ë˜ì–´ ì¶”ê°€ ë…¸ì¶œ
- ì‹¤ìŠµ ëª©í‘œ: í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì•± ê°œë°œ ë° MSA ì•„í‚¤í…ì²˜ ê²½í—˜

---

## ğŸ“† ê°œë°œ ê¸°ê°„ 8ì¼ - 2025.06.25 (ìˆ˜) ~ 07.04(ê¸ˆ)

## ğŸ—‚ï¸ ì£¼ìš” ì¼ì • ë° ì‘ì—…
- **1ì¼ì°¨ (06.25)**: OT, ë„ë©”ì¸ ì´í•´, ì—­í•  ë¶„ë‹´, User Story, Event Storming
- **2ì¼ì°¨ (06.26)**: ì „ëµ/ì „ìˆ  ì„¤ê³„, í—¥ì‚¬ê³ ë‚  ë‹¤ì´ì–´ê·¸ë¨
- **3ì¼ì°¨ (06.27)**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ êµ¬í˜„ ì‹œì‘ (Event ê¸°ë°˜)
- **4ì¼ì°¨ (06.30)**: Kafka ë©”ì‹œì§•, CQRS, í…ŒìŠ¤íŠ¸ ì‘ì„±
- **5ì¼ì°¨ (07.01)**: í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„, Docker ì´ë¯¸ì§€ ìƒì„± ë° Push
- **6ì¼ì°¨ (07.02)**: Azure ë°°í¬, ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜(HPA, ë¬´ì •ì§€ ë°°í¬)
- **7ì¼ì°¨ (07.03)**: ì„œë¹„ìŠ¤ ë©”ì‹œ ì ìš©, ëª¨ë‹ˆí„°ë§ & ë¡œê¹…
- **8ì¼ì°¨ (07.04)**: ë°°í¬ íŒŒì´í”„ë¼ì¸ ì„¤ê³„, Wrap-up, ë°œí‘œ

---

## ğŸ‘¥ íŒ€ì› (AI_04ë°˜_11ì¡°)

| ì´ë¦„ | ì£¼ìš” ì—­í•  | ë‹´ë‹¹ íŒŒíŠ¸ | ì£¼ìš” ê¸°ì—¬ ë‚´ìš© |
| :---------- | :--- | :--- | :--- |
| ì´í—Œì¤€ | ì¡°ì¥ | PM, ë°°í¬ (AKS & CD) | ë¶„ì—… ë° ì‘ì—… ë‚´ìš© í™•ì¸, AKS ë°°í¬ ë° CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• |
| ê¹€ì‹œí›ˆ | ë°œí‘œ, PPT | AI ë„ë©”ì¸ ê°œë°œ (Backend) | AI ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì„¤ê³„ ë° ë°±ì—”ë“œ ì½”ë“œ ì‘ì„± |
| ì•ˆë„í˜• | PPT | êµ¬ë…ì ë„ë©”ì¸ ê°œë°œ (Backend), FE ì§€ì› | êµ¬ë…ì ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì„¤ê³„, ì½”ë“œ ì •ë¦¬ ë° README ì‘ì„± |
| ë°•ìˆ˜ì—° | PPT | ì„œì¬ ë„ë©”ì¸ ê°œë°œ (Backend) | ì„œì¬ ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì„¤ê³„ ë° ë°±ì—”ë“œ ì½”ë“œ ì‘ì„± |
| ì˜¤í˜„ì¢… | ê²€í†  ë‹´ë‹¹ì | ê¸€ì“°ê¸° ë„ë©”ì¸ ê°œë°œ (Backend), ëª¨ë‹ˆí„°ë§ | ê¸€ì“°ê¸° ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì„¤ê³„, ë°°í¬ í™˜ê²½ ëª¨ë‹ˆí„°ë§, CI íŒŒì´í”„ë¼ì¸ êµ¬ì¶• |
| ì–‘ì„±í˜„ | ê²€í†  ë‹´ë‹¹ì | í¬ì¸íŠ¸ ë„ë©”ì¸ ê°œë°œ (Backend), CI/CD, FE ì§€ì› | í¬ì¸íŠ¸ ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì„¤ê³„, CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶• |
| ê¹€ë¯¼ì„œ | ê²€í†  ë‹´ë‹¹ì | ì‘ê°€ ê´€ë¦¬ ë„ë©”ì¸ ë‹´ë‹¹, FE ì§€ì›, AKS ë°°í¬ | ì‘ê°€ ê´€ë¦¬ ë„ë©”ì¸ MSAEZ ì•„í‚¤í…ì²˜ ì œì‘ ë° ë°±ì—”ë“œ ì½”ë“œ ì‘ì„±, AKS ë°°í¬ |
| ë¥˜ê·¼ìš° | ì„œê¸°, PPT | í”„ë¡ íŠ¸ì—”ë“œ ì´ê´„, ë°±ì—”ë“œ í†µí•© | MSAEZ í†µí•© ë° ìˆ˜ì •, API ëª…ì„¸ì„œ ì œì‘, BE ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, FE ì œì‘ |

---

### ğŸ“ ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ 5ì°¨ Notion  
[KT-AIVLE ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ 5ì°¨ AI ê¸°ë°˜ ìë™ ì¶œê°„ ë° êµ¬ë… í”Œë«í¼ ë§Œë“¤ê¸° Notion ìƒì„¸ ì„¤ëª… ë° íšŒì˜ë¡](https://www.notion.so/KT-AIVLE-5-21dd02208fab809d91b2d97bc2c7ab09)  
- [KT ê±·ë‹¤ê°€ ì„œì¬ - ìƒì„¸ API ëª…ì„¸ì„œ](https://www.notion.so/API-227d02208fab80df8d02f035b3a55e0e)  
---

## **ğŸ“ ë„ì„œ ê´€ë¦¬ ì‹œìŠ¤í…œ ê²°ê³¼ë¬¼**



---


---

# ğŸ“š ì†ŒìŠ¤ì½”ë“œ ì„¤ëª…

---

<details>
<summary><strong>ğŸ¤– AI Service</strong></summary>

## AI ìš”ì•½ ìƒì„± (ContentAnalyzer)

**íŠ¸ë¦¬ê±°**: `BookRegisted` ì´ë²¤íŠ¸ ìˆ˜ì‹   
**ì²˜ë¦¬**: GPTë¥¼ í™œìš©í•œ ì½˜í…ì¸  ìš”ì•½ + ì¥ë¥´ ë¶„ë¥˜  
**ë°œí–‰**: `AiSummarized` ì´ë²¤íŠ¸  
**í•µì‹¬ ë¡œì§**: ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€, 2ë‹¨ê³„ AI ì²˜ë¦¬ (ìš”ì•½ â†’ ë¶„ë¥˜)

```java
// AI ìš”ì•½ ìƒì„± - 2ë‹¨ê³„ ì²˜ë¦¬
String initialSummary = gptService.generateSummary(
    bookRegisted.getContext(), 500, "KO", "ì¼ë°˜ìš”ì•½"
);
String classifiedGenre = gptService.classifyGenre(
    bookRegisted.getTitle(), initialSummary
);

// ì´ë²¤íŠ¸ ë°œí–‰
AiSummarized aiSummarized = new AiSummarized(contentAnalyzer);
aiSummarized.publishAfterCommit();
```

## AI í‘œì§€ ìƒì„± (CoverDesign)

**íŠ¸ë¦¬ê±°**: REST API ìš”ì²­ ë˜ëŠ” `AiSummarized` ì´ë²¤íŠ¸  
**ì²˜ë¦¬**: DALL-Eë¥¼ í™œìš©í•œ í‘œì§€ ì´ë¯¸ì§€ ìƒì„±  
**ë°œí–‰**: `CoverCreated` ì´ë²¤íŠ¸  
**í•µì‹¬ ë¡œì§**: ìš”ì•½ ê²°ê³¼ í™œìš©ìœ¼ë¡œ ê³ í’ˆì§ˆ í‘œì§€ ìƒì„±

```java
// AI í‘œì§€ ìƒì„±
DalleService dalleService = new DalleService();
String imageUrl = dalleService.generateCoverImage(title, context);

// ìš”ì•½ ê²°ê³¼ í™œìš©í•œ ê³ í’ˆì§ˆ í‘œì§€ ìƒì„±
String contextForImage = analyzer.getSummary() != null ? 
    analyzer.getSummary() : analyzer.getContext();

// ì´ë²¤íŠ¸ ë°œí–‰
CoverCreated coverCreated = new CoverCreated(coverDesign);
coverCreated.publishAfterCommit();
```

## PolicyHandler

**íŠ¸ë¦¬ê±°**: Kafka ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹   
**ì²˜ë¦¬**: ì´ë²¤íŠ¸ ê¸°ë°˜ ìˆœì°¨ ì²˜ë¦¬ ë° ì¤‘ë³µ ë°©ì§€  
**í•µì‹¬ ë¡œì§**: ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€, ìˆœì°¨ ì‹¤í–‰, í’ˆì§ˆ ê°œì„  ì²˜ë¦¬

```java
// BookRegisted ì´ë²¤íŠ¸ ì²˜ë¦¬ - ìˆœì°¨ì  AI ì²˜ë¦¬
@StreamListener(condition = "headers['type']=='BookRegisted'")
public void wheneverBookRegisted_ProcessSequentially(@Payload BookRegisted bookRegisted) {
    // ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
    if (contentAnalysisExists && coverExists) {
        return;
    }
    
    // ìˆœì°¨ì  AI ì²˜ë¦¬
    ContentAnalyzer.aiSummarize(event);
    CoverDesign.autoCoverGeneratePolicy(event);
}
```


</details>

<details>
<summary><strong>ğŸ‘¤ AuthorManage</strong></summary>

## ì‘ê°€ ìŠ¹ì¸ ì²˜ë¦¬ (AuthorAggregate)

**íŠ¸ë¦¬ê±°**: ê´€ë¦¬ìì˜ `ë“±ë¡ ìŠ¹ì¸` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: ì‘ê°€ ìŠ¹ì¸ ìƒíƒœ ì—…ë°ì´íŠ¸  
**ë°œí–‰**: `AuthorApproved` ì´ë²¤íŠ¸  
**í•µì‹¬ ë¡œì§**: ê´€ë¦¬ì ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°, ì‘ê°€ ìƒíƒœ ê´€ë¦¬

```java
// ì‘ê°€ ìŠ¹ì¸ ì´ë²¤íŠ¸ ë°œí–‰
AuthorApproved authorApproved = new AuthorApproved(author);
authorApproved.setAuthorId(author.getAuthorId());
authorApproved.setIsApproved(true);
```

## AuthorApproved ì´ë²¤íŠ¸ êµ¬ì¡°

```java
@Data
public class AuthorApproved extends AbstractEvent {
    private Long authorId;      //  ì‘ê°€ ID
    private Boolean isApproved; //  ìŠ¹ì¸ ìƒíƒœ
    private String name;        //  ì‘ê°€ ì´ë¦„
}
```

</details>

<details>
<summary><strong>âœï¸ WriteManage</strong></summary>

## ì±… ë“±ë¡ ì²˜ë¦¬ (WritingAggregate)

**íŠ¸ë¦¬ê±°**: ì‘ê°€ì˜ `ì±… ë“±ë¡` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: ì±… ì •ë³´ ì €ì¥ ë° ë“±ë¡ ìƒíƒœ ì„¤ì •  
**ë°œí–‰**: `BookRegisted` ì´ë²¤íŠ¸  
**í•µì‹¬ ë¡œì§**: ì‘ê°€ ì¸ì¦ í›„ ì±… ë“±ë¡, ê¸€ ì‘ì„±/ìˆ˜ì •/ì‚­ì œ ê´€ë¦¬

```java
// ì±… ë“±ë¡ ì´ë²¤íŠ¸ ë°œí–‰
BookRegisted bookRegisted = new BookRegisted(writing);
bookRegisted.setBookId(writing.getBookId());
bookRegisted.setTitle(writing.getTitle());
bookRegisted.setRegistration(true);
```

## BookRegisted ì´ë²¤íŠ¸ êµ¬ì¡°

```java
@Data
public class BookRegisted extends AbstractEvent {
    private Long bookId;        //  ì±… ID
    private String context;     //  ì±… ë‚´ìš©
    private Long authorId;      //  ì‘ê°€ ID
    private String title;       //  ì±… ì œëª©
    private Boolean registration; //  ë“±ë¡ ìƒíƒœ
}
```

</details>

<details>
<summary><strong>ğŸ‘¥ SubscribeManage</strong></summary>

## PolicyHandler

```java
@Service
@Transactional
public class PolicyHandler {
    @Autowired
    UserRepository userRepository;
    
    @Autowired
    LibraryRepository libraryRepository;

    // í¬ì¸íŠ¸ ê°ì†Œ ì´ë²¤íŠ¸ ì²˜ë¦¬
    @StreamListener(condition = "headers['type']=='PointDecreased'")
    public void wheneverPointDecreased_PointSyncPolicy(@Payload PointDecreased pointDecreased) {
        User.pointSyncPolicy(event); // ì‚¬ìš©ì í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”
    }

    // í¬ì¸íŠ¸ ì¶©ì „ ì´ë²¤íŠ¸ ì²˜ë¦¬
    @StreamListener(condition = "headers['type']=='PointRecharged'")
    public void wheneverPointRecharged_PointSyncPolicy(@Payload PointRecharged pointRecharged) {
        User.pointSyncPolicy(event); // ì‚¬ìš©ì í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”
    }

    // KT ê°€ì… í¬ì¸íŠ¸ ì§€ê¸‰ ì´ë²¤íŠ¸ ì²˜ë¦¬
    @StreamListener(condition = "headers['type']=='KtSignedupPointCharged'")
    public void wheneverKtSignedupPointCharged_PointSyncPolicy(@Payload KtSignedupPointCharged ktSignedupPointCharged) {
        User.pointSyncPolicy(event); // KT ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ë™ê¸°í™”
    }

    // ì¼ë°˜ ê°€ì… í¬ì¸íŠ¸ ì§€ê¸‰ ì´ë²¤íŠ¸ ì²˜ë¦¬
    @StreamListener(condition = "headers['type']=='StandardSignedupPointCharged'")
    public void wheneverStandardSignedupPointCharged_PointSyncPolicy(@Payload StandardSignedupPointCharged standardSignedupPointCharged) {
        User.pointSyncPolicy(event); // ì¼ë°˜ ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ë™ê¸°í™”
    }

    // ë„ì„œ ì¶œê°„ ì´ë²¤íŠ¸ ì²˜ë¦¬
    @StreamListener(condition = "headers['type']=='Published'")
    public void wheneverPublished_BookInfoPolicy(@Payload Published published) {
        Library.bookInfoPolicy(event); // ë„ì„œ ì •ë³´ Libraryì— ë™ê¸°í™”
    }
}
```

## ì²˜ë¦¬í•˜ëŠ” ì™¸ë¶€ ì´ë²¤íŠ¸

**PointDecreased**: í¬ì¸íŠ¸ ì°¨ê° (êµ¬ë§¤ ì‹œ)  
**PointRecharged**: í¬ì¸íŠ¸ ì¶©ì „  
**KtSignedupPointCharged**: KT ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ì§€ê¸‰  
**StandardSignedupPointCharged**: ì¼ë°˜ ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ì§€ê¸‰  
**Published**: ë„ì„œ ì¶œê°„ ì •ë³´

## ì‚¬ìš©ì ë“±ë¡ ì²˜ë¦¬ (UserAggregate)

**íŠ¸ë¦¬ê±°**: ì‚¬ìš©ìì˜ `íšŒì›ê°€ì…` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: ì‚¬ìš©ì ì •ë³´ ì €ì¥ ë° ë“±ë¡ ìƒíƒœ ì„¤ì •  
**ë°œí–‰**: `UserRegistered` ì´ë²¤íŠ¸

## ì‚¬ìš©ì ì •ë³´ ìˆ˜ì • ì²˜ë¦¬

**íŠ¸ë¦¬ê±°**: ì‚¬ìš©ìì˜ `íšŒì›ì •ë³´ìˆ˜ì •` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸  
**ë°œí–‰**: `UserUpdated` ì´ë²¤íŠ¸

## êµ¬ë… ì„œë¹„ìŠ¤ ê°€ì… ì²˜ë¦¬

**íŠ¸ë¦¬ê±°**: ì‚¬ìš©ìì˜ `êµ¬ë…ê°€ì…` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: ì›” êµ¬ë… ìƒíƒœ í™œì„±í™”  
**ë°œí–‰**: `BookServiceSubscribed` ì´ë²¤íŠ¸

## ê°œë³„ ì±… êµ¬ë§¤ ì²˜ë¦¬

**íŠ¸ë¦¬ê±°**: ì‚¬ìš©ìì˜ `ì†Œì¥` ì»¤ë§¨ë“œ  
**ì²˜ë¦¬**: í¬ì¸íŠ¸ ì°¨ê° ë° ì±… ì†Œì¥ ê¶Œí•œ ë¶€ì—¬  
**ë°œí–‰**: `BuyBookSub` ì´ë²¤íŠ¸

## ì£¼ìš” ì´ë²¤íŠ¸ êµ¬ì¡°

```java
// ğŸ‘¤ ì‚¬ìš©ì ë“±ë¡
@Data
public class UserRegistered extends AbstractEvent {
    private Long userId;    //  ì‚¬ìš©ì ID
    private String isKt;    //  KT ê³„ì • ì—¬ë¶€
}

// ğŸ’ êµ¬ë… ì„œë¹„ìŠ¤ ê°€ì…
@Data
public class BookServiceSubscribed extends AbstractEvent {
    private Long userId;           //  ì‚¬ìš©ì ID
    private String isSubscribe;    //  êµ¬ë… ìƒíƒœ
}

// ğŸ›’ ê°œë³„ ì±… êµ¬ë§¤
@Data
public class BuyBookSub extends AbstractEvent {
    private Long userId;    //  ì‚¬ìš©ì ID
    private Long bookId;    //  ì±… ID
}
```


</details>

<details>
<summary><strong>ğŸ’° Point Service</strong></summary>

## PolicyHandler

```java
@Service
@Transactional
public class PolicyHandler {
    
    // ê°œë³„ ì±… êµ¬ë§¤ ì‹œ í¬ì¸íŠ¸ ì°¨ê°
    @StreamListener(condition = "headers['type']=='BuyBookSub'")
    public void wheneverBuyBookSub_PointDecrease(@Payload BuyBookSub buyBookSub) {
        Point.pointDecrease(event);
    }

    // êµ¬ë… ì„œë¹„ìŠ¤ ê°€ì… ì‹œ í¬ì¸íŠ¸ ì°¨ê°
    @StreamListener(condition = "headers['type']=='BookServiceSubscribed'")
    public void wheneverBookServiceSubscribed_PointDecrease(@Payload BookServiceSubscribed bookServiceSubscribed) {
        Point.pointDecrease(event);
    }

    // ì‹ ê·œ íšŒì› ê°€ì… ì‹œ ì´ˆê¸° í¬ì¸íŠ¸ ì§€ê¸‰
    @StreamListener(condition = "headers['type']=='UserRegistered'")
    public void wheneverUserRegistered_InitialPointPolicy(@Payload UserRegistered userRegistered) {
        Point.initialPointPolicy(event);
    }

    // KT ê³„ì • ì—°ë™ ì‹œ ì¶”ê°€ í¬ì¸íŠ¸ ì§€ê¸‰
    @StreamListener(condition = "headers['type']=='UserUpdated'")
    public void wheneverUserUpdated_KtSignedupPointPolicy(@Payload UserUpdated userUpdated) {
        Point.ktSignedupPointPolicy(event);
    }
}
```

## ë°œí–‰í•˜ëŠ” ì´ë²¤íŠ¸ êµ¬ì¡°

```java
// ğŸ’¸ í¬ì¸íŠ¸ ì°¨ê° ì™„ë£Œ ì´ë²¤íŠ¸
@Data
public class PointDecreased extends AbstractEvent {
    private Long userId;            //  ì‚¬ìš©ì ID
    private Integer pointBalance;   //  ì°¨ê° í›„ ì”ì•¡
}

// ğŸ’³ í¬ì¸íŠ¸ ì¶©ì „ ì™„ë£Œ ì´ë²¤íŠ¸
@Data
public class PointRecharged extends AbstractEvent {
    private Long userId;            //  ì‚¬ìš©ì ID
    private Integer pointBalance;   //  ì¶©ì „ í›„ ì”ì•¡
}

// ğŸ“± KT ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ì§€ê¸‰
@Data
public class KtSignedupPointCharged extends AbstractEvent {
    private Long userId;            //  ì‚¬ìš©ì ID
    private Integer pointBalance;   //  ì§€ê¸‰ í›„ ì”ì•¡
}

// ğŸ ì¼ë°˜ ê°€ì… í˜œíƒ í¬ì¸íŠ¸ ì§€ê¸‰
@Data
public class StandardSignedupPointCharged extends AbstractEvent {
    private Long userId;            //  ì‚¬ìš©ì ID
    private Integer pointBalance;   //  ì§€ê¸‰ í›„ ì”ì•¡
}
```


</details>

<details>
<summary><strong>ğŸ“š LibraryPlatform</strong></summary>

## ì´ë²¤íŠ¸ ì¡°í•© ì²˜ë¦¬ (Event Orchestration)

```java
@Service
@Transactional
public class PolicyHandler {
    
    // ì„ì‹œ ì €ì¥ì†Œ: bookId ê¸°ì¤€ìœ¼ë¡œ ì´ë²¤íŠ¸ ë§¤ì¹­
    private Map<Long, AiSummarized> aiSummarizedMap = new ConcurrentHashMap<>();
    private Map<Long, CoverCreated> coverCreatedMap = new ConcurrentHashMap<>();

    // AI ìš”ì•½ ì™„ë£Œ ì´ë²¤íŠ¸ ìˆ˜ì‹  ë° ì„ì‹œ ì €ì¥
    @StreamListener(condition = "headers['type']=='AiSummarized'")
    public void wheneverAiSummarized(@Payload AiSummarized aiSummarized) {
        Long bookId = aiSummarized.getBookId();
        aiSummarizedMap.put(bookId, aiSummarized);
        publishIfReady(bookId);
    }

    // AI í‘œì§€ ìƒì„± ì™„ë£Œ ì´ë²¤íŠ¸ ìˆ˜ì‹  ë° ì„ì‹œ ì €ì¥
    @StreamListener(condition = "headers['type']=='CoverCreated'")
    public void wheneverCoverCreated(@Payload CoverCreated coverCreated) {
        Long bookId = coverCreated.getBookId();
        coverCreatedMap.put(bookId, coverCreated);
        publishIfReady(bookId);
    }

    // ë‘ ì´ë²¤íŠ¸ê°€ ëª¨ë‘ ìˆ˜ì‹ ë˜ë©´ ì¶œê°„ëœ ë„ì„œ ì •ë³´ ë°œí–‰
    private void publishIfReady(Long bookId) {
        AiSummarized aiEvent = aiSummarizedMap.get(bookId);
        CoverCreated coverEvent = coverCreatedMap.get(bookId);

        if (aiEvent != null && coverEvent != null) {
            LibraryInfo.publish(aiEvent, coverEvent); // ì¶œê°„ëœ ë„ì„œ ì •ë³´ ë°œí–‰
            aiSummarizedMap.remove(bookId);
            coverCreatedMap.remove(bookId);
        }
    }
}
```

## ë°œí–‰í•˜ëŠ” ì´ë²¤íŠ¸ êµ¬ì¡°

```java
// ğŸ“š ë„ì„œ ì¶œê°„ ì™„ë£Œ ì´ë²¤íŠ¸
@Data
public class Published extends AbstractEvent {
    private Long bookId;             //  ë„ì„œ ID
    private Long authorId;           //  ì‘ê°€ ID
    private String authorName;       //  ì‘ê°€ëª…
    private String title;            //  ë„ì„œ ì œëª©
    private String imageUrl;         //  AI ìƒì„± í‘œì§€ URL
    private String summary;          //  AI ìƒì„± ìš”ì•½
    private String context;          //  ë„ì„œ ë‚´ìš©
    private String classificationType; // ğŸ· AI ë¶„ë¥˜ ì¥ë¥´
    private Date publishDate;        //  ì¶œê°„ì¼
    private Long selectCount;        //  ì„ íƒ(êµ¬ë§¤) íšŸìˆ˜
    private Integer rank;            //  ë­í‚¹
    private Boolean bestseller;      //  ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì—¬ë¶€
}

// ğŸ† ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì„ ì • ì´ë²¤íŠ¸
@Data
public class BestsellerGiven extends AbstractEvent {
    // ... Publishedì™€ ë™ì¼í•œ êµ¬ì¡°
    private Boolean bestseller;      //  ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì—¬ë¶€ (true)
}
```


</details>

---

## ğŸ”— ì´ë²¤íŠ¸ íë¦„ë„

```mermaid
graph TD
    %% ì‘ê°€ ê´€ë¦¬ íë¦„
    A1[ğŸ‘¤ ì‘ê°€ ê°€ì…] --> A2[ğŸ‘¤ AuthorManage]
    A2 --> A3[âœ… AuthorApproved]
    
    %% ê¸€ ì‘ì„± ë° ì±… ë“±ë¡ íë¦„
    W1[âœï¸ ê¸€ ì‘ì„±] --> W2[âœï¸ WriteManage]
    W2 --> W3[ğŸ“– BookRegisted]
    
    %% AI ì²˜ë¦¬ íë¦„
    W3 --> AI1[ğŸ¤– AI Service]
    AI1 --> AI2[ğŸ“ AiSummarized]
    AI1 --> AI3[ğŸ¨ CoverCreated]
    
    %% ë„ì„œ ì¶œê°„ íë¦„
    AI2 --> L1[ğŸ“š LibraryPlatform]
    AI3 --> L1
    L1 --> L2[ğŸ“š Published]
    L2 --> L3[ğŸ† BestsellerGiven]
    
    %% ì‚¬ìš©ì ê´€ë¦¬ íë¦„
    U1[ğŸ‘¥ ì‚¬ìš©ì ê°€ì…] --> U2[ğŸ‘¥ SubscribeManage]
    U2 --> U3[ğŸ” UserRegistered]
    U3 --> P1[ğŸ’° Point Service]
    P1 --> P2[ğŸ StandardSignedupPointCharged]
    
    %% êµ¬ë… ë° êµ¬ë§¤ íë¦„
    U2 --> U4[ğŸ’ BookServiceSubscribed]
    U2 --> U5[ğŸ›’ BuyBookSub]
    
    %% í¬ì¸íŠ¸ ì²˜ë¦¬ íë¦„
    U4 --> P1
    U5 --> P1
    P1 --> P3[ğŸ’¸ PointDecreased]
    P1 --> P4[ğŸ’³ PointRecharged]
    P1 --> P5[ğŸ“± KtSignedupPointCharged]
    
    %% í¬ì¸íŠ¸ ë™ê¸°í™”
    P3 --> U2
    P4 --> U2
    P5 --> U2
    P2 --> U2
    
    %% ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—…ë°ì´íŠ¸
    U5 --> L1
    L2 --> U2
    
    %% ìŠ¤íƒ€ì¼ë§
    classDef authorService fill:#FFE5CC
    classDef writeService fill:#E5F2FF
    classDef aiService fill:#F0E5FF
    classDef subscribeService fill:#E5FFE5
    classDef pointService fill:#FFE5F0
    classDef libraryService fill:#FFFACD
    classDef event fill:#FFF0E5
    
    class A1,A2,A3 authorService
    class W1,W2,W3 writeService
    class AI1,AI2,AI3 aiService
    class U1,U2,U3,U4,U5 subscribeService
    class P1,P2,P3,P4,P5 pointService
    class L1,L2,L3 libraryService
```

## ğŸ“Š ì„œë¹„ìŠ¤ ê°„ ì´ë²¤íŠ¸ ì—°ê²° ë§¤íŠ¸ë¦­ìŠ¤

**ë°œí–‰ ì„œë¹„ìŠ¤ â†’ ì´ë²¤íŠ¸ â†’ êµ¬ë… ì„œë¹„ìŠ¤**

ğŸ‘¤ AuthorManage â†’ `AuthorApproved` â†’ ì‘ê°€ ìŠ¹ì¸ ì™„ë£Œ  
âœï¸ WriteManage â†’ `BookRegisted` â†’ ğŸ¤– AI Service (AI ìš”ì•½ ë° í‘œì§€ ìƒì„±)  
ğŸ¤– AI Service â†’ `AiSummarized` â†’ ğŸ“š LibraryPlatform (ë„ì„œ ì¶œê°„ ì¤€ë¹„)  
ğŸ¤– AI Service â†’ `CoverCreated` â†’ ğŸ“š LibraryPlatform (ë„ì„œ ì¶œê°„ ì¤€ë¹„)  
ğŸ“š LibraryPlatform â†’ `Published` â†’ ğŸ‘¥ SubscribeManage (ë„ì„œ ì •ë³´ ë™ê¸°í™”)  
ğŸ“š LibraryPlatform â†’ `BestsellerGiven` â†’ ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì„ ì •  
ğŸ‘¥ SubscribeManage â†’ `UserRegistered` â†’ ğŸ’° Point Service (ì‹ ê·œ ê°€ì… í¬ì¸íŠ¸ ì§€ê¸‰)  
ğŸ‘¥ SubscribeManage â†’ `UserUpdated` â†’ ğŸ’° Point Service (KT ì—°ë™ í¬ì¸íŠ¸ ì§€ê¸‰)  
ğŸ‘¥ SubscribeManage â†’ `BookServiceSubscribed` â†’ ğŸ’° Point Service (êµ¬ë…ë£Œ í¬ì¸íŠ¸ ì°¨ê°)  
ğŸ‘¥ SubscribeManage â†’ `BuyBookSub` â†’ ğŸ’° Point Service, ğŸ“š LibraryPlatform (í¬ì¸íŠ¸ ì°¨ê°, ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€)  
ğŸ’° Point Service â†’ `PointDecreased` â†’ ğŸ‘¥ SubscribeManage (í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”)  
ğŸ’° Point Service â†’ `PointRecharged` â†’ ğŸ‘¥ SubscribeManage (í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”)  
ğŸ’° Point Service â†’ `KtSignedupPointCharged` â†’ ğŸ‘¥ SubscribeManage (í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”)  
ğŸ’° Point Service â†’ `StandardSignedupPointCharged` â†’ ğŸ‘¥ SubscribeManage (í¬ì¸íŠ¸ ì”ì•¡ ë™ê¸°í™”)
